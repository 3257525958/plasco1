<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù¾ÙˆØ² S800</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .step-card { border-left: 4px solid #0d6efd; margin-bottom: 10px; }
        .step-success { border-left-color: #198754; background-color: #d1e7dd; }
        .step-error { border-left-color: #dc3545; background-color: #f8d7da; }
        .step-warning { border-left-color: #ffc107; background-color: #fff3cd; }
        .ip-badge { cursor: pointer; }
        .ip-badge:hover { opacity: 0.8; }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-12">
                <h1 class="text-center mb-4">ğŸ”„ ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù¾ÙˆØ² S800</h1>

                <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø¨Ú©Ù‡ -->
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        ğŸŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø¨Ú©Ù‡ Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ± Ø´Ù…Ø§
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Ù†Ø§Ù… Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±:</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" value="{{ hostname }}" readonly id="hostnameInput">
                                        <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('hostnameInput')">
                                            ğŸ“‹
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">IP Ø¹Ù…ÙˆÙ…ÛŒ:</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" value="{{ public_ip }}" readonly id="publicIpInput">
                                        <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('publicIpInput')">
                                            ğŸ“‹
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Ù¾ÙˆØ±Øª Ø¨Ø±Ù†Ø§Ù…Ù‡:</label>
                                    <input type="number" class="form-control" id="port" value="1362">
                                </div>
                            </div>
                        </div>

                        <!-- Ù†Ù…Ø§ÛŒØ´ IPÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ -->
                        <div class="mb-3">
                            <label class="form-label">IPÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ (Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù¾ÙˆØ²):</label>
                            <div id="localIpsContainer">
                                {% for ip in local_ips %}
                                <span class="badge bg-primary ip-badge me-2 mb-2" onclick="selectIp('{{ ip }}')">
                                    {{ ip }} ğŸ“‹
                                </span>
                                {% empty %}
                                <div class="alert alert-warning">
                                    IP Ù…Ø­Ù„ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯!
                                </div>
                                {% endfor %}
                            </div>
                            <small class="form-text text-muted">
                                Ø±ÙˆÛŒ Ù‡Ø± IP Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ Ø¯Ø± ÙÛŒÙ„Ø¯ Ø²ÛŒØ± Ù‚Ø±Ø§Ø± Ú¯ÛŒØ±Ø¯
                            </small>
                        </div>

                        <!-- ÙÛŒÙ„Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ IP -->
                        <div class="mb-3">
                            <label class="form-label">IP Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù¾ÙˆØ²:</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="ipAddress" value="{{ primary_ip }}" placeholder="IP Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ± Ø´Ù…Ø§">
                                <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('ipAddress')">
                                    ğŸ“‹ Ú©Ù¾ÛŒ
                                </button>
                                <button class="btn btn-outline-info" type="button" onclick="refreshNetworkInfo()">
                                    ğŸ”„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
                                </button>
                            </div>
                            <small class="form-text text-muted">
                                Ø§ÛŒÙ† Ø¢Ø¯Ø±Ø³ Ø±Ø§ Ø¯Ø± Ù‚Ø³Ù…Øª <strong>Server IP</strong> Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù¾ÙˆØ² ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯
                            </small>
                        </div>

                        <!-- Ù†ÙˆØ¹ Ø§ØªØµØ§Ù„ -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Ù†ÙˆØ¹ Ø§ØªØµØ§Ù„:</label>
                                    <select class="form-select" id="connectionType">
                                        <option value="LAN">LAN (Ø´Ø¨Ú©Ù‡)</option>
                                        <option value="SERIAL">SERIAL (Ø³Ø±ÛŒØ§Ù„)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6" id="serialSection" style="display: none;">
                                <div class="mb-3">
                                    <label class="form-label">Ù¾ÙˆØ±Øª Ø³Ø±ÛŒØ§Ù„:</label>
                                    <input type="text" class="form-control" id="comPort" value="COM1">
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-warning">
                            <strong>âš ï¸ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªÙ†Ø¸ÛŒÙ… Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù¾ÙˆØ²:</strong>
                            <ul class="mb-0 mt-2">
                                <li>IP Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø¨Ø§Ù„Ø§ Ø±Ø§ Ø¯Ø± Ù‚Ø³Ù…Øª <strong>Server IP</strong> Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù¾ÙˆØ² ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</li>
                                <li>Ù¾ÙˆØ±Øª <strong>1362</strong> Ø±Ø§ Ø¯Ø± Ù‚Ø³Ù…Øª <strong>Server Port</strong> ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</li>
                                <li>Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ± Ùˆ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù¾ÙˆØ² Ø¯Ø± ÛŒÚ© Ø´Ø¨Ú©Ù‡ Ù‡Ø³ØªÙ†Ø¯</li>
                                <li>ÙØ§ÛŒØ±ÙˆØ§Ù„ Ø¨Ø§ÛŒØ¯ Ø§Ø¬Ø§Ø²Ù‡ Ø§Ø±ØªØ¨Ø§Ø· Ø±ÙˆÛŒ Ù¾ÙˆØ±Øª 1362 Ø±Ø§ Ø¨Ø¯Ù‡Ø¯</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Ù†Ù…Ø§ÛŒØ´ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ¹Ù„ÛŒ -->
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ¹Ù„ÛŒ Ø§ØªØµØ§Ù„
                    </div>
                    <div class="card-body">
                        <div id="currentSettings" class="alert alert-light">
                            Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...
                        </div>
                    </div>
                </div>

                <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù‚Ø¯Ø§Ù… -->
                <div class="card mb-4">
                    <div class="card-body text-center">
                        <button class="btn btn-success btn-lg me-3" onclick="testConnection()">
                            ğŸ” ØªØ³Øª Ø§ØªØµØ§Ù„
                        </button>
                        <button class="btn btn-primary btn-lg" onclick="makePayment()">
                            ğŸ’³ Ù¾Ø±Ø¯Ø§Ø®Øª 1250 ØªÙˆÙ…Ø§Ù†
                        </button>
                    </div>
                </div>

                <!-- Ù†Ù…Ø§ÛŒØ´ Ù…Ø±Ø§Ø­Ù„ -->
                <div class="card">
                    <div class="card-header bg-secondary text-white">
                        ğŸ“‹ Ù…Ø±Ø§Ø­Ù„ Ø§Ø¬Ø±Ø§
                    </div>
                    <div class="card-body">
                        <div id="stepsContainer">
                            <div class="alert alert-info">
                                Ù„Ø·ÙØ§ ÛŒÚ©ÛŒ Ø§Ø² Ø¹Ù…Ù„ÛŒØ§Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù„Ø§ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ -->
                <div id="finalResult" class="mt-4" style="display: none;"></div>
            </div>
        </div>
    </div>

    <script>
        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ IP
        function selectIp(ip) {
            document.getElementById('ipAddress').value = ip;
            updateCurrentSettings();
            showStep(`âœ… IP ${ip} Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯`, 'success');
        }

        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ú©Ù¾ÛŒ Ø¨Ù‡ Ú©Ù„ÛŒÙ¾â€ŒØ¨ÙˆØ±Ø¯
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            element.setSelectionRange(0, 99999);
            document.execCommand('copy');

            // Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ù„Ø§Ù†
            const originalText = element.value;
            showStep(`ğŸ“‹ "${originalText}" Ú©Ù¾ÛŒ Ø´Ø¯`, 'success');
        }

        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ¹Ù„ÛŒ
        function updateCurrentSettings() {
            const connectionType = document.getElementById('connectionType').value;
            const ip = document.getElementById('ipAddress').value;
            const port = document.getElementById('port').value;
            const comPort = document.getElementById('comPort').value;

            let settingsText = `Ù†ÙˆØ¹ Ø§ØªØµØ§Ù„: <strong>${connectionType}</strong> | IP: <strong>${ip}</strong> | Ù¾ÙˆØ±Øª: <strong>${port}</strong>`;
            if (connectionType === 'SERIAL') {
                settingsText += ` | Ù¾ÙˆØ±Øª Ø³Ø±ÛŒØ§Ù„: <strong>${comPort}</strong>`;
            }

            document.getElementById('currentSettings').innerHTML = settingsText;
        }

        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø¨Ú©Ù‡
        function refreshNetworkInfo() {
            showStep('ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø¨Ú©Ù‡...', 'warning');

            fetch('/pos/get-network-info/')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª IPÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ
                        const container = document.getElementById('localIpsContainer');
                        container.innerHTML = '';

                        data.local_ips.forEach(ip => {
                            const badge = document.createElement('span');
                            badge.className = 'badge bg-primary ip-badge me-2 mb-2';
                            badge.textContent = ip + ' ğŸ“‹';
                            badge.onclick = () => selectIp(ip);
                            container.appendChild(badge);
                        });

                        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ IP Ø¹Ù…ÙˆÙ…ÛŒ
                        document.getElementById('publicIpInput').value = data.public_ip;

                        // Ø§Ú¯Ø± IP Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ø§Ø³ØªØŒ Ø¢Ù† Ø±Ø§ Ø¨Ù‡ Ø±ÙˆØ² Ú©Ù†ÛŒÙ…
                        const currentIp = document.getElementById('ipAddress').value;
                        if (!data.local_ips.includes(currentIp) && data.local_ips.length > 0) {
                            document.getElementById('ipAddress').value = data.primary_ip;
                        }

                        updateCurrentSettings();
                        showStep('âœ… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø¨Ú©Ù‡ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯', 'success');
                    } else {
                        showStep('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø¨Ú©Ù‡', 'error');
                    }
                })
                .catch(error => {
                    showStep('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø¨Ú©Ù‡: ' + error, 'error');
                });
        }

        // ØªØºÛŒÛŒØ± Ù†Ù…Ø§ÛŒØ´ ÙØ±Ù… Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹ Ø§ØªØµØ§Ù„
        document.getElementById('connectionType').addEventListener('change', function() {
            const serialSection = document.getElementById('serialSection');
            if (this.value === 'SERIAL') {
                serialSection.style.display = 'block';
            } else {
                serialSection.style.display = 'none';
            }
            updateCurrentSettings();
        });

        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‡Ù†Ú¯Ø§Ù… ØªØºÛŒÛŒØ± Ù…Ù‚Ø§Ø¯ÛŒØ±
        document.getElementById('ipAddress').addEventListener('input', updateCurrentSettings);
        document.getElementById('port').addEventListener('input', updateCurrentSettings);
        document.getElementById('comPort').addEventListener('input', updateCurrentSettings);

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentSettings();

            // Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§ÙˆÙ„ÛŒÙ‡
            showStep(`ğŸ’» Ù†Ø§Ù… Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±: {{ hostname }}`, 'info');
            showStep(`ğŸŒ IP Ø¹Ù…ÙˆÙ…ÛŒ: {{ public_ip }}`, 'info');
            showStep(`ğŸ  IPÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ: {{ local_ips|join:', ' }}`, 'info');
        });

        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø² ÙØ±Ù…
        function getConnectionConfig() {
            return {
                connection_type: document.getElementById('connectionType').value,
                ip: document.getElementById('ipAddress').value,
                port: parseInt(document.getElementById('port').value),
                com_port: document.getElementById('comPort').value
            };
        }

        function testConnection() {
            const config = getConnectionConfig();

            // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
            if (!config.ip) {
                alert('Ù„Ø·ÙØ§ Ø¢Ø¯Ø±Ø³ IP Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            if (!config.port) {
                alert('Ù„Ø·ÙØ§ Ù¾ÙˆØ±Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            showStep(`â³ Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ ${config.ip}:${config.port}...`, 'warning');

            fetch('/pos/test-connection/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: JSON.stringify(config)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showStep(`âœ… ${data.message}`, 'success');
                    showStep(`ğŸ“¡ Ø¢Ø¯Ø±Ø³ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡: ${data.ip_used}:${data.port_used}`, 'success');
                    showFinalResult('âœ… ' + data.message, 'success');
                } else {
                    showStep(data.message, 'error');
                    showFinalResult('âŒ ' + data.message, 'error');
                }
            })
            .catch(error => {
                showStep('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±: ' + error, 'error');
                showFinalResult('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±', 'error');
            });
        }

        function makePayment() {
            const config = getConnectionConfig();

            // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
            if (!config.ip) {
                alert('Ù„Ø·ÙØ§ Ø¢Ø¯Ø±Ø³ IP Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            if (!config.port) {
                alert('Ù„Ø·ÙØ§ Ù¾ÙˆØ±Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…Ø±Ø§Ø­Ù„ Ù‚Ø¨Ù„ÛŒ
            document.getElementById('stepsContainer').innerHTML = '';
            document.getElementById('finalResult').style.display = 'none';

            showStep(`ğŸš€ Ø´Ø±ÙˆØ¹ ÙØ±Ø¢ÛŒÙ†Ø¯ Ù¾Ø±Ø¯Ø§Ø®Øª 1250 ØªÙˆÙ…Ø§Ù†ÛŒ Ø¨Ù‡ Ø¢Ø¯Ø±Ø³ ${config.ip}:${config.port}...`, 'warning');

            fetch('/pos/make-payment/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: JSON.stringify(config)
            })
            .then(response => response.json())
            .then(data => {
                // Ù†Ù…Ø§ÛŒØ´ ØªÙ…Ø§Ù… Ù…Ø±Ø§Ø­Ù„
                if (data.steps) {
                    data.steps.forEach(step => {
                        const stepType = step.includes('âŒ') ? 'error' :
                                       step.includes('âœ…') ? 'success' : 'warning';
                        showStep(step, stepType);
                    });
                }

                // Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ
                if (data.success) {
                    showStep(`ğŸ“¡ Ø¢Ø¯Ø±Ø³ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡: ${data.ip_used}`, 'success');
                    showFinalResult('ğŸ‰ ' + data.message, 'success');
                } else {
                    showFinalResult('âŒ ' + data.message, 'error');
                }
            })
            .catch(error => {
                showStep('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±: ' + error, 'error');
                showFinalResult('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±', 'error');
            });
        }

        function showStep(message, type) {
            const stepsContainer = document.getElementById('stepsContainer');
            const stepDiv = document.createElement('div');
            stepDiv.className = `step-card p-3 ${type === 'success' ? 'step-success' : type === 'error' ? 'step-error' : 'step-warning'}`;
            stepDiv.textContent = message;
            stepsContainer.appendChild(stepDiv);
            stepsContainer.scrollTop = stepsContainer.scrollHeight;
        }

        function showFinalResult(message, type) {
            const finalResult = document.getElementById('finalResult');
            finalResult.innerHTML = `
                <div class="alert alert-${type === 'success' ? 'success' : 'danger'}">
                    <h4>${message}</h4>
                </div>
            `;
            finalResult.style.display = 'block';
        }

        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
    </script>
</body>
</html>